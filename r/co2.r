df <- read.table("ftp://aftp.cmdl.noaa.gov/products/trends/co2/co2_mm_mlo.txt", header = FALSE, skip = 51)
co2 <- ts(data = df$V5, start=c(1958,3), frequency=12)
fit <- stl(co2, s.window=5)
plot(co2, col="gray", main="Atmospheric CO2", ylab="ppm", xlab="")
lines(fit$time.series[,2],col="red",ylab="Trend")
plot(fit)
monthplot(fit$time.series[,"seasonal"], main="", ylab="Seasonal")
fcast <- forecast::forecast(fit, h = 12 * 10)
plot(fcast, ylab="ppm")
